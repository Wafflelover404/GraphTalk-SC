# json-prompt.md - Спецификация стандарта SC-Machine JSON

## Обзор
Этот файл содержит формальную спецификацию стандарта SC-Machine JSON, используемого в системе GraphTalk. Он определяет структуру и правила для преобразования текста на естественном языке в машинно-читаемые семантические представления.

## Назначение документа
- **Шаблон для промптов LLM**: Используется `json-llm.py` для структурированного преобразования текста
- **Определение стандарта**: Формальная спецификация для семантического формата JSON
- **Справочник по валидации**: Рекомендации по обеспечению соответствия вывода
- **Хранилище примеров**: Содержит примеры трансформаций и крайние случаи

## Определение структуры

### Основная схема JSON
```json
{
  "[Тип связи]": {
    "[Субъектный узел]": "[Объектный узел]",
    "[Субъектный узел]": ["Объектный узел (массив при необходимости)"]
  },
  "membership": {
    "[Узел]": ["Модификатор 1", "Модификатор 2"]
  },
  "Source content": "[Исходный входной текст]"
}
```

## Основные компоненты

### Типы связей
Семантические отношения выражены как глагольные фразы в именительном падеже:
- **Примеры на русском**: `"Обучаться в"`, `"Работать в"`, `"Принадлежать к"`
- **Формат**: Глагол в инфинитиве + предлог при необходимости
- **Назначение**: Определяет природу отношений между сущностями

### Узлы
Сущности и понятия в именительном падеже:
- **Субъекты**: Действующие сущности (`"Я"`, `"студент"`, `"компания"`)
- **Объекты**: Целевые сущности (`"технопарк"`, `"университет"`, `"проект"`)
- **Согласованность**: Одна и та же сущность должна использовать одинаковый идентификатор на протяжении всего текста

### Принадлежность
Атрибуты и модификаторы для узлов:
- **Формат**: Идентификатор узла, сопоставленный с массивом описательных терминов
- **Содержание**: Прилагательные, классификации, свойства
- **Падеж**: Все модификаторы в именительном падеже
- **Пример**: `"технопарк": ["Национальный", "детский"]`

### Исходный контент
- **Требование**: Обязательное поле во всех выводах
- **Содержание**: Точная копия исходного входного текста
- **Назначение**: Обеспечение отслеживаемости и проверки
- **Кодировка**: Сохранена точно, как было получено

## Процесс трансформации

### Пример трансформации
**Вход:**
```
"Я обучаюсь в Национальном детском технопарке"
```

**Шаг 1: Лингвистический анализ**
- Субъект: "Я" (I)
- Глагол: "обучаюсь" → нормализуется в "Обучаться в"
- Объект: "технопарке" → нормализуется в "технопарк"
- Модификаторы: "Национальном детском" → ["Национальный", "детский"]

**Шаг 2: Структура JSON**
```json
{
  "Обучаться в": {
    "Я": "технопарк"
  },
  "membership": {
    "технопарк": ["Национальный", "детский"]
  },
  "Source content": "Я обучаюсь в Национальном детском технопарке"
}
```

## Правила валидации

### Требования к синтаксису
1. **Валидный JSON**: Должен разбирается без ошибок
2. **Строки в кавычках**: Все ключи и строковые значения должны быть в кавычках
3. **Разделение запятыми**: Правильное использование запятых между элементами
4. **Соответствие скобок**: Правильное вложение объектов и массивов

### Семантические требования
1. **Типы связей**: Должны быть осмысленными глагольными фразами
2. **Согласованность узлов**: Одна и та же сущность использует один и тот же идентификатор
3. **Именительный падеж**: Все русские слова в именительной форме
4. **Сохранение источника**: Исходный текст точно воспроизведен

### Требования к полноте
1. **Исходный контент**: Должен присутствовать во всех выводах
2. **Непустая структура**: Как минимум одна связь или принадлежность
3. **Содержательное отображение**: Связи должны отражать действительные отношения

## Руководства по обработке языка

### Нормализация падежа
- **Из**: Склоненные формы (`"технопарке"`, `"Национальном"`)
- **В**: Именительные формы (`"технопарк"`, `"Национальный"`)
- **Метод**: Автоматическое обнаружение и преобразование

### Обработка глаголов
- **Извлечение**: Основной семантический глагол из предложения
- **Нормализация**: Преобразование в инфинитив + формат предлога
- **Примеры**: 
  - `"изучает"` → `"Изучать"`
  - `"работает в"` → `"Работать в"`
  - `"принадлежит к"` → `"Принадлежать к"`

### Извлечение модификаторов
- **Идентификация**: Прилагательные и описательные фразы
- **Группировка**: Ассоциация с правильным сущ.
- **Нормализация**: Преобразование в именительный падеж
- **Формат массива**: Несколько модификаторов как элементы массива

## Крайние случаи и специальная обработка

### Массивы в связях
```json
{
  "Изучать": {
    "студент": ["математика", "физика", "химия"]
  }
}
```
Использовать, когда один субъект относится к нескольким объектам.

### Множественные связи
```json
{
  "Обучаться в": {
    "Я": "технопарк"
  },
  "Изучать": {
    "Я": "программирование"
  },
  "membership": {
    "технопарк": ["Национальный", "детский"],
    "программирование": ["основы"]
  }
}
```

### Сложные предложения
Для предложений с несколькими частями извлекайте все значимые семантические отношения, сохраняя при этом атрибуцию источника.

### Недостающая информация
Когда некоторые семантические компоненты неясны:
- Пропускайте неясные отношения, а не угадывайте
- Фокусируйтесь на явно выраженных связях
- Обеспечьте точность захвата

## Использование в системе GraphTalk

### Интеграция с LLM
- **Загрузка файлов**: Чтение `json-llm.py` в качестве базового промпта
- **Создание промпта**: Комбинирует с конкретными инструкциями
- **Валидация ответа**: Используется для проверки соответствия вывода LLM

### Обеспечение качества
- **Проверка формата**: Гарантия валидности JSON
- **Соответствие стандарту**: Проверка соблюдения правил структуры
- **Семантическая валидация**: Проверка значимого извлечения содержимого

### Конвейер обработки
1. **Получение входных данных**: Текст на естественном языке
2. **Создание промпта**: Комбинация с этой спецификацией
3. **Обработка LLM**: Генерация структурированного JSON
4. **Валидация**: Проверка согласно правилам этого документа
5. **Вывод**: Соответствующий SC-Machine JSON

## Рекомендации по обслуживанию

### Обновление стандарта
1. **Контроль версий**: Отслеживание изменений в спецификации
2. **Совместимость**: Обеспечение обратной совместимости, когда возможно
3. **Документация**: Обновление примеров и правил одновременно
4. **Тестирование**: Проверка изменений на существующем контенте

### Управление примерами
- **Разнообразие**: Включение различных структур предложений
- **Ясность**: Каждый пример должен демонстрировать конкретное правило
- **Точность**: Убедитесь, что все примеры соответствуют стандарту
- **Охват языка**: Включает различные языковые паттерны

## Интеграция с OSTIS

### Заполнение базы знаний
Сгенерированные структуры JSON могут быть:
- Преобразованы в формат SCS для импорта в OSTIS
- Использованы как промежуточное представление для обновлений БЗ
- Обработаны инструментами семантического анализа
- Интегрированы с существующими графами знаний
